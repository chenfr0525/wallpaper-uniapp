{"version":3,"names":["selectList","common_vendor","ref","isSearch","historySearch","index","getStorageSync","list","queryParams","pageNum","pageSize","keyword","search","_ref","_asyncToGenerator2","_regeneratorRuntime2","mark","_callee","item","wrap","_callee$","_context","prev","next","value","_toConsumableArray2","Set","concat","setStorageSync","getClassifyItem","stop","_x","apply","arguments","deleteList","isNoData","_ref2","_callee2","_list$value","res","_callee2$","_context2","api_api","apiSearchWall","_objectSpread2","sent","push","length","onReachBottom","queryparams","reSearch","_readOnlyError2","wx","createPage","MiniProgramPage"],"sources":["search.vue","D:/Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvc2VhcmNoL3NlYXJjaC52dWU"],"sourcesContent":["<script setup>\r\n\timport {\r\n\t\tref\r\n\t} from 'vue'\r\n\timport {\r\n\t\tapiSelectList,\r\n\t\tapiSearchWall\r\n\t} from '../../api/api.js'\r\n\timport {\r\n\t\tonReachBottom\r\n\t} from '@dcloudio/uni-app'\r\n\tconst selectList = ref([])\r\n\tconst isSearch = ref(true)\r\n\t//历史搜索\r\n\tconst historySearch = ref(uni.getStorageSync('wall-historySearch') || [])\r\n\tconst list = ref([])\r\n\t//查询参数\r\n\tconst queryParams = ref({\r\n\t\tpageNum: 1,\r\n\t\tpageSize: 12,\r\n\t\tkeyword: \"\"\r\n\t})\r\n\t//获取主题推荐\r\n\tconst getSelectList = async () => {\r\n\t\tlet res = await apiSelectList({\r\n\t\t\tselect: true\r\n\t\t})\r\n\t\tselectList.value = res\r\n\t}\r\n\r\n\t//搜索跳转\r\n\tconst search = async (item) => {\r\n\t\tqueryParams.value.keyword = queryParams.value.keyword || item\r\n\t\thistorySearch.value = [...new Set([queryParams.value.keyword, ...historySearch.value])]\r\n\t\tuni.setStorageSync('wall-historySearch', historySearch.value)\r\n\r\n\t\tgetClassifyItem()\r\n\t}\r\n\t//清理缓存\r\n\tconst deleteList = () => {\r\n\t\tuni.setStorageSync(\"wall-historySearch\", [])\r\n\t\thistorySearch.value = uni.getStorageSync('wall-historySearch')\r\n\t}\r\n\t//是否存在数据\r\n\tconst isNoData = ref(false)\r\n\tconst getClassifyItem = async () => {\r\n\t\tlet res = await apiSearchWall({\r\n\t\t\t...queryParams.value,\r\n\t\t})\r\n\t\tlist.value.push(...res)\r\n\t\tif (12 > res.length) isNoData.value = true\r\n\t\tisSearch.value = false\r\n\t}\r\n\t//触底时继续加载\r\n\tonReachBottom(() => {\r\n\t\tif (isNoData.value) return\r\n\t\tqueryparams.value.pageNum++\r\n\t\tgetClassifyItem()\r\n\t})\r\n\r\n\t//重新搜索\r\n\tconst reSearch = () => {\r\n\t\tisSearch = true;\r\n\t\tlist.value = []\r\n\t}\r\n</script>\r\n\r\n<template>\r\n\t<view class=\"searchLayout\">\r\n\t\t<view class=\"input\" @click=\"reSearch\">\r\n\t\t\t<uni-search-bar @confirm=\"search(queryParams.keyword)\" :focus=\"true\" v-model=\"queryParams.keyword\">\r\n\t\t\t</uni-search-bar>\r\n\t\t</view>\r\n\t\t<view class=\"record\" v-if=\"isSearch\">\r\n\t\t\t<record-item @startSearch=\"search\" title=\"最近搜索\" :list=\"historySearch\"\r\n\t\t\t\t:icon=\"historySearch.length!==0?true:false\" @deleteList=\"deleteList\"></record-item>\r\n\t\t\t<record-item @startSearch=\"search\" title=\"热门搜索\" :list=\"selectList\"></record-item>\r\n\t\t</view>\r\n\t\t<view class=\"classList\" v-else>\r\n\t\t\t<view class=\"content\">\r\n\t\t\t\t<navigator :url=\"'/pages/preview/preview?id='+item._id\" class=\"item\" v-for=\"item in list\"\r\n\t\t\t\t\t:key=\"item._id\">\r\n\t\t\t\t\t<image :src=\"item.smallPicurl\" mode=\"aspectFill\"></image>\r\n\t\t\t\t</navigator>\r\n\r\n\t\t\t</view>\r\n\t\t\t<load type=\"noMore\" v-if=\"isNoData\"></load>\r\n\t\t\t<view class=\"safe-area-inset-bottom\"></view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.searchLayout {\r\n\t\tpadding: 20rpx 30rpx;\r\n\r\n\t\t.record {\r\n\t\t\tpadding-top: 40rpx;\r\n\t\t}\r\n\r\n\t\t.classList {\r\n\t\t\t.content {\r\n\t\t\t\tdisplay: grid;\r\n\t\t\t\tpadding: 0 15rpx;\r\n\t\t\t\tgrid-template-columns: repeat(3, 1fr);\r\n\t\t\t\tgap: 15rpx;\r\n\r\n\t\t\t\t.item {\r\n\t\t\t\t\theight: 400rpx;\r\n\r\n\t\t\t\t\timage {\r\n\t\t\t\t\t\theight: 100%;\r\n\t\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</style>","import MiniProgramPage from 'C:/Users/23212/Desktop/practiceCode/wallpaper-uniapp/pages/search/search.vue'\nwx.createPage(MiniProgramPage)"],"mappings":"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","ignoreList":[]}